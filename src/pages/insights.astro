---
import Base from '../layouts/Base.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.jsx';
import siteConfig from '../site.config.js';
import OptimizedImage from '../components/OptimizedImage.astro';
import mediumArticles from '../data/medium.json';

// SEO meta data
const seoData = {
  title: "Insights - Data Analytics Articles & Resources",
  description: "Explore the latest insights on data analytics, business intelligence, and data strategy. Access articles, guides, and resources for data professionals.",
  image: "/og-image-insights.png"
};

// Medium configuration
const MEDIUM_USERNAME = siteConfig.mediumUsername;
const MEDIUM_URL = `https://medium.com/@${MEDIUM_USERNAME}`;
const MEDIUM_RSS_URL = `https://medium.com/feed/@${MEDIUM_USERNAME}`;

// Function to format date
function formatDate(dateString) {
  return new Date(dateString).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}

// Categories for filtering
const categories = [
  "All",
  "Data Strategy",
  "Business Intelligence",
  "Data Visualization",
  "Analytics",
  "Machine Learning",
  "Data Governance",
  "Data Science"
];

// Define colors for category-based thumbnails
const categoryColors = {
  "Data Strategy": "#4F46E5", // Indigo
  "Business Intelligence": "#059669", // Emerald
  "Data Visualization": "#D97706", // Amber
  "Data Governance": "#7C3AED", // Violet
  "Machine Learning": "#2563EB", // Blue
  "Analytics": "#059669", // Emerald
  "Data Science": "#2563EB", // Blue
  "default": "#4F46E5" // Default color
};

// Define icons for category-based thumbnails
const categoryIcons = {
  "Data Strategy": "üìä",
  "Business Intelligence": "üìà",
  "Data Visualization": "üìâ",
  "Data Governance": "üîê",
  "Machine Learning": "ü§ñ",
  "Analytics": "üìä",
  "Data Science": "üß™",
  "default": "üìù"
};

// Function to extract excerpt from content
function extractExcerpt(content, maxLength = 150) {
  // Remove HTML tags
  const textContent = content.replace(/<[^>]*>/g, '');
  // Trim and limit length
  return textContent.trim().substring(0, maxLength) + (textContent.length > maxLength ? '...' : '');
}

// Function to determine categories based on title and content
function determineCategories(title, content) {
  const allCategories = [];
  
  // Check title and content for category keywords
  categories.forEach(category => {
    if (category !== "All" && 
        (title.toLowerCase().includes(category.toLowerCase()) || 
         content.toLowerCase().includes(category.toLowerCase()))) {
      allCategories.push(category);
    }
  });
  
  // If no categories matched, add a default one
  if (allCategories.length === 0) {
    allCategories.push("Analytics");
  }
  
  return allCategories;
}

// Function to get thumbnail color based on categories
function getThumbnailColor(articleCategories) {
  // Use the first category for the color, or default if none
  const primaryCategory = articleCategories[0] || "default";
  return categoryColors[primaryCategory] || categoryColors["default"];
}

// Function to get thumbnail icon based on categories
function getThumbnailIcon(articleCategories) {
  // Use the first category for the icon, or default if none
  const primaryCategory = articleCategories[0] || "default";
  return categoryIcons[primaryCategory] || categoryIcons["default"];
}

// Default selected category
let selectedCategory = "All";
---

<Base {...seoData}>
  <Navbar />
    <!-- Header Section -->
  <section class="bg-gray-900 text-white py-20">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-6">Insights</h1>
        <p class="text-xl text-gray-300 mb-8">
          Data Analytics Articles & Strategic Resources for Business Leaders
        </p>
      </div>
    </div>
  </section>

  <!-- Articles Intro -->
  <section class="py-8 bg-white text-center">
    <div class="container mx-auto px-6">
      <p class="text-lg text-gray-700 max-w-2xl mx-auto mb-6">
        These are my featured long-form articles published on Medium. They go deeper into concepts, frameworks, and BI strategy.
      </p>
    </div>
  </section>

  <!-- Articles Section -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-6">
      <div class="max-w-6xl mx-auto">
        <!-- Category Filters -->
        <div class="mb-12">
          <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">Explore Articles by Topic</h2>
          
          <div class="flex flex-wrap justify-center gap-3">
            {categories.map(category => (
              <button 
                class={`px-5 py-2 rounded-full text-sm font-medium transition-colors ${selectedCategory === category ? 'bg-brandGreen text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}
                data-category={category}
              >
                {category}
              </button>
            ))}
          </div>
        </div>
        
        {mediumArticles.length > 0 ? (
          <!-- Medium Articles Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {mediumArticles.map(article => (
            <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300" data-categories={article.categories.join(',')}>
              <div class="h-48 relative flex items-center justify-center" style={`background-color: ${article.thumbnailColor}`}>
                <span class="text-6xl">{article.thumbnailIcon}</span>
              </div>
              
              <div class="p-6">
                <div class="flex flex-wrap gap-2 mb-4">
                  {article.categories.map(category => (
                    <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs">{category}</span>
                  ))}
                </div>
                
                <h3 class="text-xl font-bold text-gray-900 mb-2 line-clamp-2">{article.title}</h3>
                <p class="text-gray-500 mb-4 text-sm">{formatDate(article.pubDate)}</p>
                <p class="text-gray-600 mb-6 line-clamp-3">{article.excerpt}</p>
                
                <a 
                  href={article.link} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="text-brandGreen hover:text-green-700 font-semibold inline-flex items-center"
                >
                  Read on Medium
                  <svg class="w-4 h-4 ml-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                  </svg>
                </a>
              </div>
            </div>
          ))}        </div>
        ) : (
          <div class="text-center py-12">
            <svg class="w-16 h-16 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <h3 class="text-xl font-bold text-gray-700 mb-2">No articles found</h3>
            <p class="text-gray-500 mb-6">There was a problem fetching the latest articles.</p>
            <a href={MEDIUM_URL} target="_blank" rel="noopener noreferrer" class="text-brandGreen hover:text-green-700 font-semibold">
              Visit Medium Profile
            </a>
          </div>
        )}
        
        <!-- Newsletter CTA -->
        <div class="mt-16 bg-gray-50 rounded-xl p-8 text-center">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Stay Updated with the Latest Insights</h3>
          <p class="text-lg text-gray-600 mb-6 max-w-3xl mx-auto">
            Subscribe to my newsletter to receive new articles, resources, and data analytics insights directly in your inbox.
          </p>
          <div class="max-w-md mx-auto">
            <form class="flex flex-col sm:flex-row gap-3">
              <input 
                type="email" 
                placeholder="Your email address" 
                class="flex-grow px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-brandGreen focus:border-transparent"
                required
              />
              <button 
                type="submit"
                class="bg-brandGreen hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors"
              >
                Subscribe
              </button>
            </form>
            <p class="text-sm text-gray-500 mt-3">
              I respect your privacy. Unsubscribe at any time.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Topics Section -->
  <section class="py-16 bg-gray-50">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="text-3xl font-bold text-gray-900 mb-12">Featured Topics</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- Topic 1 -->
          <div class="bg-white rounded-xl shadow-lg p-8 hover:shadow-xl transition-shadow duration-300">
            <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
              </svg>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-4">Data Strategy</h3>
            <p class="text-gray-600 mb-6">
              Comprehensive guides on building effective data strategies that align with business objectives and drive organizational growth.
            </p>
            <a href="/tag/data-strategy" class="text-blue-500 hover:text-blue-700 font-semibold">
              Explore Data Strategy
            </a>
          </div>
          
          <!-- Topic 2 -->
          <div class="bg-white rounded-xl shadow-lg p-8 hover:shadow-xl transition-shadow duration-300">
            <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
              </svg>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-4">Analytics & BI</h3>
            <p class="text-gray-600 mb-6">
              Practical insights on analytics implementation, business intelligence tools, and techniques for deriving actionable insights from data.
            </p>
            <a href="/tag/analytics" class="text-purple-500 hover:text-purple-700 font-semibold">
              Explore Analytics
            </a>
          </div>
          
          <!-- Topic 3 -->
          <div class="bg-white rounded-xl shadow-lg p-8 hover:shadow-xl transition-shadow duration-300">
            <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg class="w-8 h-8 text-white" viewBox="0 0 24 24" fill="currentColor">
                <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6A4.997 4.997 0 0 1 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"/>
              </svg>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-4">Data Innovation</h3>
            <p class="text-gray-600 mb-6">
              Explore cutting-edge data technologies, AI applications, and innovative approaches to solving complex business problems with data.
            </p>
            <a href="/tag/innovation" class="text-green-500 hover:text-green-700 font-semibold">
              Explore Innovation
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <Footer />
  
  <script>
    // Filter articles by category
    document.addEventListener('DOMContentLoaded', () => {
      const categoryButtons = document.querySelectorAll('[data-category]');
      const articleCards = document.querySelectorAll('[data-categories]');
      
      categoryButtons.forEach(button => {
        button.addEventListener('click', () => {
          const category = button.getAttribute('data-category');
          
          // Update active button
          categoryButtons.forEach(btn => {
            btn.classList.remove('bg-brandGreen', 'text-white');
            btn.classList.add('bg-gray-100', 'text-gray-700', 'hover:bg-gray-200');
          });
          
          button.classList.remove('bg-gray-100', 'text-gray-700', 'hover:bg-gray-200');
          button.classList.add('bg-brandGreen', 'text-white');
          
          // Filter articles
          articleCards.forEach(card => {
            const cardCategories = card.getAttribute('data-categories').split(',');
            
            if (category === 'All' || cardCategories.includes(category)) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          });
        });
      });
    });
  </script>
</Base>